<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="screen-orientation" content="landscape">
    <meta name="x5-orientation" content="landscape">
    <meta name="full-screen" content="yes">
    <title>麻将大师 | Mahjong Master</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="css/style.css?v=44">
</head>
<body data-theme="guofeng">
    <div id="app">
        <div id="game-container" class="game-container">
            <canvas id="game-canvas"></canvas>
        </div>

        <header class="game-header">
            <div class="header-left">
                <button id="menu-btn" class="icon-btn">☰</button>
                <span id="rule-display" class="rule-display">四川麻将</span>
            </div>
            <div class="header-center">
                <div class="all-scores">
                    <span class="score-item" id="score-player-0">你: 20000</span>
                    <span class="score-item" id="score-player-1">西: 20000</span>
                    <span class="score-item" id="score-player-2">北: 20000</span>
                    <span class="score-item" id="score-player-3">东: 20000</span>
                </div>
            </div>
            <div class="header-right">
                <button id="sound-btn" class="icon-btn active">🔊</button>
                <button id="skin-btn" class="icon-btn">🎨</button>
            </div>
        </header>

        <footer class="game-footer">
            <div class="footer-left">
                <span id="tiles-left">剩余: 0</span>
                <span id="ting-display" class="ting-display hidden"></span>
            </div>
            <div class="footer-center">
                <div id="action-buttons" class="action-buttons hidden">
                    <button id="chi-btn" class="action-btn" data-action="chi">吃</button>
                    <button id="peng-btn" class="action-btn" data-action="peng">碰</button>
                    <button id="gang-btn" class="action-btn" data-action="gang">杠</button>
                    <button id="hu-btn" class="action-btn highlight" data-action="hu">胡</button>
                    <button id="guo-btn" class="action-btn" data-action="guo">过</button>
                </div>
            </div>
            <div class="footer-right">
                <span id="round-display">第 0 局</span>
            </div>
        </footer>

        <div id="start-modal" class="modal">
            <div class="modal-content start-modal">
                <h2>🀄 麻将大师</h2>
                <p class="subtitle">多规则跨平台麻将游戏</p>

                <div class="rule-select">
                    <label>选择规则</label>
                    <select id="rule-select">
                        <option value="sichuan">四川麻将（血战到底）</option>
                        <option value="guangdong">广东麻将（推倒胡）</option>
                        <option value="japan">日本麻将（立直麻将）</option>
                        <option value="international">国际麻将（通用规则）</option>
                    </select>
                </div>

                <div class="difficulty-select">
                    <label>AI难度</label>
                    <div class="difficulty-buttons">
                        <button class="diff-btn" data-level="1">简单</button>
                        <button class="diff-btn active" data-level="2">中等</button>
                        <button class="diff-btn" data-level="3">困难</button>
                    </div>
                </div>

                <div class="stats-preview">
                    <div class="stat-row">
                        <span>总局数</span>
                        <span id="stat-total">0</span>
                    </div>
                    <div class="stat-row">
                        <span>胜率</span>
                        <span id="stat-winrate">0%</span>
                    </div>
                    <div class="stat-row">
                        <span>最高番数</span>
                        <span id="stat-maxfan">0番</span>
                    </div>
                </div>

                <button id="start-btn" class="start-btn">开始游戏</button>
                <button id="continue-btn" class="continue-btn hidden">继续游戏</button>
            </div>
        </div>

        <div id="settings-modal" class="modal hidden">
            <div class="modal-content settings-modal">
                <h3>设置</h3>
                
                <div class="setting-item">
                    <label>主题风格</label>
                    <select id="theme-select">
                        <option value="guofeng">国风传统</option>
                        <option value="japanese">日式简约</option>
                        <option value="modern">现代卡通</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label>音效语言</label>
                    <select id="language-select">
                        <option value="zh">普通话</option>
                        <option value="sichuan">四川话</option>
                        <option value="cantonese">粤语</option>
                        <option value="japanese">日语</option>
                        <option value="english">English</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label>音效</label>
                    <button id="sound-toggle" class="toggle-btn active">开启</button>
                </div>

                <div class="setting-item">
                    <label>自动保存</label>
                    <button id="autosave-toggle" class="toggle-btn active">开启</button>
                </div>

                <div class="setting-item">
                    <label>皮肤中心</label>
                    <button id="open-skin-btn" class="ctrl-btn primary">打开</button>
                </div>

                <div class="setting-actions">
                    <button id="save-settings-btn" class="ctrl-btn primary">保存</button>
                    <button id="close-settings-btn" class="ctrl-btn">关闭</button>
                </div>
            </div>
        </div>

        <div id="result-modal" class="modal hidden">
            <div class="modal-content result-modal">
                <h2 id="result-title">🎉 胡牌！</h2>
                <div id="result-content" class="result-content">
                    <div class="result-section">
                        <h4>胡牌玩家</h4>
                        <div id="hu-player" class="hu-player"></div>
                    </div>
                    <div class="result-section">
                        <h4>番型</h4>
                        <div id="fan-types" class="fan-types"></div>
                    </div>
                    <div class="result-section">
                        <h4>得分详情</h4>
                        <div id="score-result" class="score-result"></div>
                    </div>
                    <div class="result-section">
                        <h4>积分变化</h4>
                        <div id="score-changes" class="score-changes"></div>
                    </div>
                    <div class="result-section">
                        <h4>玩家手牌</h4>
                        <div id="player-hands" class="player-hands"></div>
                    </div>
                </div>
                <div class="modal-btns">
                    <button id="play-again-btn" class="ctrl-btn primary">再来一局</button>
                    <button id="back-menu-btn" class="ctrl-btn">返回主菜单</button>
                </div>
            </div>
        </div>

        <div id="que-men-modal" class="modal hidden">
            <div class="modal-content que-men-modal">
                <h3>请选择缺门</h3>
                <div class="que-men-options">
                    <button class="que-men-btn" data-men="wan">缺万</button>
                    <button class="que-men-btn" data-men="tiao">缺条</button>
                    <button class="que-men-btn" data-men="tong">缺筒</button>
                </div>
            </div>
        </div>

        <div id="skin-modal" class="modal hidden">
            <div class="modal-content skin-modal skin-modal-large">
                <h3>🎨 皮肤中心</h3>
                <div class="skin-section">
                    <h4>麻将牌样式</h4>
                    <div class="skin-list" id="skin-list"></div>
                </div>
                <div class="skin-section">
                    <h4>预览</h4>
                    <div class="skin-preview" id="skin-preview">
                        <canvas id="skin-preview-canvas" width="280" height="160"></canvas>
                    </div>
                </div>
                <div class="skin-section">
                    <h4>皮肤工具</h4>
                    <div class="skin-tools">
                        <button id="generate-emoji-skin-btn" class="ctrl-btn">生成彩色Emoji皮肤包</button>
                        <button id="load-custom-skin-btn" class="ctrl-btn">加载自定义皮肤</button>
                    </div>
                    <p class="skin-hint">1. 选择保存目录（如:桌面)
                    2. 点击"生成"按钮
                    3. 程序会在皮肤中心创建 emoji_color 文件夹
                    4. 在皮肤中心选择"彩色Emoji"皮肤</p>
                </div>
                <div class="skin-actions">
                    <button id="apply-skin-btn" class="ctrl-btn primary">应用皮肤</button>
                    <button id="close-skin-btn" class="ctrl-btn">关闭</button>
                </div>
            </div>
        </div>

        <div id="toast" class="toast hidden"></div>
        <div id="loading" class="loading hidden">
            <div class="loading-spinner"></div>
            <span>加载中...</span>
        </div>
    </div>

    <script src="js/core/mahjongTiles.js?v=44"></script>
    <script src="js/core/ruleEngine.js?v=44"></script>
    <script src="js/rules/ruleSichuan.js?v=44"></script>
    <script src="js/rules/ruleGuangdong.js?v=44"></script>
    <script src="js/rules/ruleJapan.js?v=44"></script>
    <script src="js/rules/ruleInternational.js?v=44"></script>
    <script src="js/aiLogic.js?v=44"></script>
    <script src="js/storage.js?v=44"></script>
    <script src="js/sound.js?v=44"></script>
    <script src="js/mahjongUI.js?v=44"></script>
    <script src="js/scoreSystem.js?v=44"></script>
    <script src="js/animation.js?v=44"></script>
    <script src="js/resourceLoader.js?v=44"></script>
    <script src="js/skinManager.js?v=44"></script>
    <script src="js/main.js?v=44"></script>
</body>
</html>
