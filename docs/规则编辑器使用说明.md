# 麻将规则编辑器使用说明

## 📖 简介

麻将规则编辑器是一个功能强大的可视化工具，允许用户无需编程基础即可创建、编辑和管理自定义麻将规则。支持全球各类麻将玩法，特别覆盖了丰富的东北地方特色麻将。

## 🚀 快速开始

### 打开编辑器

有三种方式可以打开规则编辑器：

1. **游戏界面快捷按钮**：点击游戏右上角的 📝 按钮
2. **设置菜单**：进入设置 → 点击"规则编辑器"按钮
3. **规则选择**：开始游戏时选择"⚙️ 自定义规则..."

### 界面布局

```
┌─────────────────────────────────────────────────┐
│  🀄 麻将规则编辑器                    [?] [×]  │
├──────────────┬──────────────────────────────────┤
│ 规则模板     │ 基本信息 牌池配置 对局规则 ...   │
│ ├ 主流玩法   ├──────────────────────────────────┤
│ ├ 东北特色   │                                  │
│ ├ 地方玩法   │         编辑区域                 │
│ └ 自定义     │                                  │
│              │                                  │
│ [+新建]     ├──────────────────────────────────┤
│ [📥导入]    │ [💾保存] [✅应用]  [📤导出] ...  │
└──────────────┴──────────────────────────────────┘
```

## 📋 功能详解

### 一、规则模板库

#### 主流玩法
- **四川麻将（血战到底）**：108 张牌，必须缺一门，血战到底
- **广东麻将（推倒胡）**：136 张牌，可吃碰杠
- **日本麻将（立直麻将）**：136 张牌，立直、宝牌、振听
- **国际麻将（国标）**：144 张牌，81 番型，8 番起胡

#### 东北特色麻将 ⭐
- **齐齐哈尔麻将**：红中百搭，闭门翻倍，禁吃
- **吉林麻将**：夹胡才能吃，宝牌百搭
- **哈尔滨麻将**：宝牌翻倍，可吃碰杠
- **沈阳麻将**：庄家翻倍，杠开加分
- **葫芦岛麻将**：一炮多响，宝中宝翻倍

#### 地方玩法
- **长沙麻将**：红中百搭
- **武汉麻将**：红中赖子杠

### 二、编辑维度

#### 1. 基本信息
- 规则名称、描述、分类

#### 2. 牌池配置
- **总牌数**：108/136/144 张
- **牌的种类**：万/条/筒/风牌/箭牌/花牌
- **百搭牌/赖子**：启用后指定百搭牌类型

#### 3. 对局规则
- **庄家规则**：产生方式、特权、连庄
- **流局规则**：条件、查叫、查苞米

#### 4. 动作规则
- **吃牌**：是否允许、条件（任意/夹胡/门前清）
- **碰牌**：是否允许、倍数
- **杠牌**：明/暗/加/抢杠、杠上花/炮

#### 5. 胡牌条件
- **基本牌型**：4 组 +1 将/七对
- **特殊要求**：门清、缺一门、番数门槛
- **特殊胡牌**：天胡/地胡/人胡/十三幺等

#### 6. 番型计分
- **计分方式**：番数制/豆制/分数制
- **封顶规则**：启用后设置上限
- **可选番型**：从番型库中选择

#### 7. 东北特色 🌟
- **宝牌规则**：产生方式、作用、宝中宝
- **闭门/开门**：倍数、漏胡不赔
- **豆牌规则**：最大豆数
- **漏胡规则**：禁胡当轮/本轮

### 三、规则管理

#### 新建规则
1. 点击"➕ 新建规则"
2. 可选择基于模板创建
3. 编辑后保存

#### 保存规则
1. 编辑完成后点击"💾 保存规则"
2. 自动验证规则合法性
3. 保存到本地存储

#### 导入/导出
- **导出**：选择规则 → 点击"📤 导出规则" → 下载 JSON 文件
- **导入**：点击"📥 导入规则" → 选择 JSON 文件

#### 复制规则
- 基于现有规则创建副本
- 方便在原有规则上修改

#### 删除规则
- 仅支持删除自定义规则
- 系统模板不可删除

### 四、预览与测试

#### 规则预览
- **摘要预览**：快速查看规则要点
- **JSON 预览**：查看完整配置数据

#### 规则验证
- 检查配置冲突
- 提供修正建议
- 错误/警告/提示分级显示

#### 快速测试
- 启动 AI 对局测试
- 验证规则是否正常运作

## 🎯 使用场景

### 场景 1：创建东北家乡规则
1. 选择"东北特色"分类
2. 选择最接近的模板（如齐齐哈尔麻将）
3. 根据家乡习惯调整：
   - 宝牌数量
   - 闭门倍数
   - 漏胡规则
4. 保存为"XX 县麻将"

### 场景 2：创建自定义玩法
1. 点击"新建规则"
2. 配置基础牌池
3. 设置特色规则
4. 添加专属番型
5. 保存并测试

### 场景 3：分享规则给朋友
1. 导出规则为 JSON 文件
2. 发送文件给朋友
3. 朋友导入即可使用

## 💡 最佳实践

### 规则命名建议
- 包含地区：`哈尔滨麻将 - 道里版`
- 包含特点：`四川麻将 - 无封顶`
- 包含版本：`自定义规则 v1.2`

### 规则验证提示
- ❌ 错误：必须修复，否则无法应用
- ⚠️ 警告：建议修改，不影响使用
- ℹ️ 提示：参考信息

### 常见配置组合

#### 经典四川麻将
```
牌数：108 张
吃牌：禁
缺一门：必须
血战到底：启用
查叫：启用
```

#### 齐齐哈尔麻将
```
牌数：136 张
吃牌：禁
百搭牌：红中
闭门：启用 (2 倍)
豆牌：启用
```

#### 葫芦岛麻将
```
牌数：136 张
吃牌：允许
一炮多响：启用
宝中宝：启用 (4 倍)
出牌必报：启用
```

## 🔧 技术说明

### 数据存储
- 自定义规则存储在浏览器 LocalStorage
- 数据键名：`mahjong_custom_rules`
- 支持跨会话持久化

### 规则格式
```json
{
  "version": "1.0.0",
  "rule": {
    "id": "custom_xxx",
    "mingCheng": "规则名称",
    "paiChi": { ... },
    "duiJuGuiZe": { ... },
    ...
  }
}
```

### 性能指标
- 规则加载：< 100ms
- 规则解析：< 50ms
- 验证检测：< 30ms

## ⚠️ 注意事项

1. **数据备份**：定期导出重要规则，避免浏览器清理丢失
2. **规则冲突**：系统会检测明显冲突，但建议测试后再正式使用
3. **浏览器兼容**：需要支持 LocalStorage 的现代浏览器
4. **移动端优化**：编辑器在横屏模式下体验更佳

## 🆘 常见问题

**Q: 规则保存后找不到？**
A: 请检查是否切换了浏览器，或 LocalStorage 被清理

**Q: 导入规则失败？**
A: 确认 JSON 文件格式正确，版本兼容

**Q: 测试对局无法开始？**
A: 确保规则已通过验证，无错误级问题

**Q: 如何删除模板规则？**
A: 系统模板不可删除，可复制后修改创建自定义版本

## 📞 技术支持

如有问题或建议，请通过项目 Issues 反馈。

---

*麻将规则编辑器 v1.0 - 让每个人都能创造属于自己的麻将玩法*
